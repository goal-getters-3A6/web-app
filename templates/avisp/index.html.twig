{% extends 'plat/alimentaire.html.twig' %}
{% block title %}
    <h1 style="color: black;">Avisp index</h1>
{% endblock %}
{% block body %}
<div style="height: 100px;"></div> <!-- Empty space with height 100px -->
<div class="container py-4">
    <h1 style="color: black;">Conultez avis</h1>
    <table class="table">
        <thead>
            <tr>
                <th>Commentaire</th>
                <th>Star rate</th>
                <th>Fav</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for avisp in avisps %}
            <tr>
                <td>{{ avisp.commap }}</td>
                <td>{{ avisp.star }}</td>
                <td>{{ avisp.fav ? 'Yes' : 'No' }}</td>
                <td>
                    <a href="{{ path('app_avisp_edit', {'idap': avisp.idap}) }}" class="btn btn-danger">Modifiez</a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="4">No records found</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
   
    <canvas id="ratingsChart" width="400" height="200"></canvas>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Get the canvas element
    var ctx = document.getElementById('ratingsChart').getContext('2d');
    // Define the data for the chart
    var data = {
        labels: ['1', '2', '3', '4', '5'], // Rating values
        datasets: [{
            label: 'Number of Ratings',
            backgroundColor: 'rgba(255, 99, 132, 0.2)',
            borderColor: 'rgba(255, 99, 132, 1)',
            borderWidth: 1,
            data: [{{ ratingCounts[1] | default(0) }}, {{ ratingCounts[2] | default(0) }}, {{ ratingCounts[3] | default(0) }}, {{ ratingCounts[4] | default(0) }}, {{ ratingCounts[5] | default(0) }}],
        }]
    };
    // Define the options for the chart
    var options = {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
        }
    };
    // Create the chart
    var myChart = new Chart(ctx, {
        type: 'bar',
        data: data,
        options: options
    });
</script>
{% endblock %}
